# README: Модель машинного обучения для детекции и предотвращения мошенничества в кредитных операциях

**Автор: Кузьмин Дмитрий**

## Введение

Мошенничество существует с тех пор, как существует человечество, и может принимать бесконечное множество различных форм. Кроме того, развитие новых технологий предоставляет преступникам дополнительные способы совершения мошенничества, например, в электронной коммерции

Использование кредитных карт широко распространено в современном обществе, и мошенничество с кредитными картами неуклонно растет в последние годы. Финансовые потери из-за мошенничества затрагивают не только банки, но и отдельных клиентов. Если банк теряет деньги, клиенты в конечном итоге тоже платят через более высокие процентные ставки, повышенные членские взносы и т.д.

Обнаружение мошенничества — это процесс определения, принадлежит ли новая авторизованная транзакция к мошенническим или подлинным транзакциям, исходя из набора кредитных карт транзакций. Система обнаружения мошенничества (FDS) должна не только эффективно выявлять случаи мошенничества, но и быть экономически эффективной в том смысле, что стоимость, затрачиваемая на проверку транзакций, не должна превышать потери от мошенничества.

Техники машинного обучения базируются на выводе модели предсказания на основе набора примеров. Эта модель, чаще всего параметрическая функция, позволяет предсказывать вероятность того, что транзакция является мошенничеством, на основе набора характеристик, описывающих транзакцию. В области обнаружения мошенничества использование техник обучения привлекательно по ряду причин. 

1. Они позволяют обнаруживать закономерности в данных с высокой размерностью, т.е. транзакции поступают в виде непрерывного потока и каждая транзакция определяется многими переменными.
2. Мошеннические транзакции часто коррелируют во времени и пространстве. Например, мошенники обычно пытаются совершить аферы в одном магазине с разными картами в течение короткого периода времени.
3. Методы обучения могут использоваться для обнаружения и моделирования существующих мошеннических стратегий, а также для выявления новых стратегий, связанных с необычным поведением владельцев карт.

## Проблема несбалансированных данных

Обучение на несбалансированных данных сложно, так как большинство алгоритмов не рассчитаны на большой дисбаланс по классам. В литературе традиционные методы включают применение техник выборки для балансировки данных. Можно выделить методы на уровне данных и алгоритмов. На уровне данных применяют предварительную обработку для балансировки или удаления шума, а на уровне алгоритмов адаптируют методы для лучшего обнаружения класса меньшинства.

К методам обработки данных относятся:

- Недовыборка (undersampling) — уменьшение количества объектов класса большинства путём случайного удаления, что снижает дисбаланс, но риск потери полезной информации.

- Передовыборка (oversampling), включая SMOTE — увеличение класса меньшинства путём генерации новых синтетических примеров, что помогает увеличить количество данных, но может вызвать переобучение.

Методы на уровне алгоритмов включают взвешивание классов, специальные функции потерь и методы ансамблей.

## Особенности и вызовы работы с потоковыми данными

В реальных сценариях данные поступают непрерывно, а распределение мошеннических транзакций может меняться со временем. Чтобы модель оставалась актуальной, необходимо:

1. Обновлять модель с учётом новых транзакций (инкрементальное обучение).

2. Избегать переобучения на устаревших данных, важно уметь «забывать» устаревшую информацию.

3. Сохранять релевантные примеры из класса меньшинства (мошеннические транзакции), даже если они старые, так как данные о мошенничестве ценны и ограничены.

## Этапы работы

1. Сбор и предварительная обработка данных
3. Предварительный анализ и масштабирование признаков
4. Балансировка данных
5. Обучение модели и выбор алгоритма
6. Оценка результатов

## О наборе данных

Используемый набор данных содержит транзакции по кредитным картам, совершённые в сентябре 2013 года европейскими держателями карт. Все входные признаки - числовые, являющиеся результатом преобразования главных компонент (PCA), что уменьшает размерность и убирает корреляции.

В наборе 31 числовая переменная, а также следующие важные признаки:

- Time - количество секунд, прошедших с момента первой транзакции в датасете до текущей транзакции. Этот признак помогает учитывать временную динамику транзакций.

- Amount - сумма транзакции, которая может влиять на вероятность мошенничества и использоваться для оценки экономической значимости.

- Class - целевая переменная, которая принимает значение 1 для мошеннических транзакций и 0 для легитимных.

Набор данных сильно несбалансирован: мошенничество составляет лишь 0.172% от всех транзакций (492 мошеннических из 284 807). Из-за отсутствия идентификатора владельца карты каждая транзакция рассматривается как независимый случай.

Для решения этой проблемы при обучении моделей применяется балансировка данных через создание подвыборок с равным соотношением мошеннических и нормальных транзакций - по 50% каждого класса, что позволяет модели лучше распознавать редкие мошеннические случаи и уменьшает риск смещения.
