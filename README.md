# README: Модель машинного обучения для детекции и предотвращения мошенничества в кредитных операциях

**Автор: Кузьмин Дмитрий**

## Введение

Обнаружение мошенничества - это процесс определения, принадлежит ли новая авторизованная транзакция к мошенническим или подлинным транзакциям, исходя из набора кредитных карт транзакций. Система обнаружения мошенничества (FDS) должна не только эффективно выявлять случаи мошенничества, но и быть экономически эффективной в том смысле, что стоимость, затрачиваемая на проверку транзакций, не должна превышать потери от мошенничества.

Техники машинного обучения базируются на выводе модели предсказания на основе набора примеров. Эта модель, чаще всего параметрическая функция, позволяет предсказывать вероятность того, что транзакция является мошенничеством, на основе набора характеристик, описывающих транзакцию.

## Проблема несбалансированных данных

Обучение на несбалансированных данных сложно, так как большинство алгоритмов не рассчитаны на большой дисбаланс по классам. В литературе традиционные методы включают применение техник выборки для балансировки данных. Можно выделить методы на уровне данных и алгоритмов. На уровне данных применяют предварительную обработку для балансировки или удаления шума, а на уровне алгоритмов адаптируют методы для лучшего обнаружения класса меньшинства.

К методам обработки данных относятся:

- Недовыборка (undersampling) - уменьшение количества объектов класса большинства путём случайного удаления, что снижает дисбаланс, но риск потери полезной информации.

- Передовыборка (oversampling), включая SMOTE - увеличение класса меньшинства путём генерации новых синтетических примеров, что помогает увеличить количество данных, но может вызвать переобучение.

Методы на уровне алгоритмов включают взвешивание классов, специальные функции потерь и методы ансамблей.

## Этапы работы

1. Сбор и предварительная обработка данных
2. Предварительный анализ и масштабирование признаков
3. Обучение модели и выбор алгоритма
4. Оценка результатов

## Технический стек

| Компоненты | Технологии |
|-----------|-----------|
| Язык программирования | Python 3.13 |
| ML Библиоека | scikit-learn 1.6.1 |
| Обработка данных | pandas, numpy |
| Визуализация | matplotlib, seaborn |
| Модели ML | Logistic Regression, Random Forest, Decision Trees, Gradient Boosting |

## О наборе данных

Используемый набор данных содержит транзакции по кредитным картам, совершённые в сентябре 2013 года европейскими держателями карт. Все входные признаки - числовые, являющиеся результатом преобразования главных компонент (PCA), что уменьшает размерность и убирает корреляции.

В наборе 31 числовая переменная, а также следующие важные признаки:

- Time - количество секунд, прошедших с момента первой транзакции в датасете до текущей транзакции. Этот признак помогает учитывать временную динамику транзакций.

- Amount - сумма транзакции, которая может влиять на вероятность мошенничества и использоваться для оценки экономической значимости.

- Class - целевая переменная, которая принимает значение 1 для мошеннических транзакций и 0 для легитимных.

Набор данных сильно несбалансирован: мошенничество составляет лишь 0.172% от всех транзакций (492 мошеннических из 284 807). Из-за отсутствия идентификатора владельца карты каждая транзакция рассматривается как независимый случай.
Для решения этой проблемы при обучении моделей применяется балансировка данных через создание подвыборок с равным соотношением мошеннических и нормальных транзакций - по 50% каждого класса, что позволяет модели лучше распознавать редкие мошеннические случаи и уменьшает риск смещения.

---

## Результаты обучения
| model                              |   accuracy |   precision |   recall |   f1_score |      auc |
|:-----------------------------------|-----------:|------------:|---------:|-----------:|---------:|
| Random Forest                      |   0.999596 |   0.941176  | 0.816327 |  0.874317  | 0.963027 |
| Gradient Boosting                  |   0.999526 |   0.88172   | 0.836735 |  0.858639  | 0.968385 |
| Decision Trees                     |   0.999508 |   0.87234   | 0.836735 |  0.854167  | 0.973959 |
| Logistic Regression                |   0.99914  |   0.826667  | 0.632653 |  0.716763  | 0.960549 |
| Logistic Regression (Balanced)     |   0.975528 |   0.0609756 | 0.918367 |  0.114358  | 0.972083 |
| Logistic Regression (Undersampled) |   0.960219 |   0.0383305 | 0.918367 |  0.0735895 | 0.976126 |
